-- merge2master-2020.sql - merge candidates-2020.db into candidates-master.db

ATTACH './etc/candidates-2020.db' AS twenty;
BEGIN;
INSERT INTO candidates (
	'year',
	'round',
	'state',
	'district_code',
	'district',
	'office_code',
	'office',
	'name',
	'sequence',
	'number',
	'cpf',
	'ballot_name',
	'party_id',
	'party_short',
	'party',
	'coalition_code',
	'coalition_comp',
	'coalition',
	'occupation_code',
	'occupation',
	'electoral_title',
	'age',
	'sex',
	'result_code',
	'result',
	'email',
	'election_type',
	'election_code',
	'incumbent',
	'protocol_number',
	'process_number',
	'sex2',
	'race_code',
	'race',
	'birth_state'
)
SELECT
	ANO_ELEICAO,
	NR_TURNO,
	SG_UF,
	SG_UE,
	NM_UE,
	CD_CARGO,
	DS_CARGO,
	NM_CANDIDATO,
	SQ_CANDIDATO,
	NR_CANDIDATO,
	NR_CPF_CANDIDATO,
	NM_URNA_CANDIDATO,
	NR_PARTIDO,
	SG_PARTIDO,
	NM_PARTIDO,
	SQ_COLIGACAO,
	DS_COMPOSICAO_COLIGACAO,
	NM_COLIGACAO,
	CD_OCUPACAO,
	DS_OCUPACAO,
	NR_TITULO_ELEITORAL_CANDIDATO,
	NR_IDADE_DATA_POSSE,
	CD_GENERO,
	CD_SIT_TOT_TURNO,
	DS_SIT_TOT_TURNO,
	NM_EMAIL,
	CD_TIPO_ELEICAO,
	CD_ELEICAO,
	ST_REELEICAO,
	NR_PROTOCOLO_CANDIDATURA,
	NR_PROCESSO,
	DS_GENERO,
	CD_COR_RACA,
	DS_COR_RACA,
	SG_UF_NASCIMENTO
FROM twenty.candidates;
COMMIT; 
DETACH twenty;